<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no">
<title>Secure Vault</title>
<style>
* { box-sizing:border-box; -webkit-tap-highlight-color:transparent; }
html, body { overflow-y: auto; overflow-x: hidden; }
::-webkit-scrollbar { width:0; height:0; }
body {
  margin:0;
  min-height:100vh;
  background:#0b0e17;
  font-family:Tahoma,sans-serif;
  color:#fff;
}
.container { max-width:720px; margin:auto; padding:20px; }
.card {
  background:rgba(255,255,255,0.1);
  backdrop-filter:blur(18px);
  border-radius:20px;
  padding:20px;
}
h2 { text-align:center; margin-bottom:20px; }
.field {
  margin-bottom:18px;
}
textarea, input {
  width:100%;
  border:none;
  border-radius:14px;
  padding:14px;
  background:rgba(0,0,0,.35);
  color:#fff;
  font-size:14px;
}
textarea {
  min-height:140px;
  resize:none;
  font-family:Consolas,monospace;
}
/* Ø¯Ú©Ù…Ù‡â€ŒÙ‡Ø§ÛŒ Liquid Metal (Paste, Copy, Ú†Ø´Ù…) */
.liquid-btn, .action-btn {
  background:linear-gradient(145deg, #2a2f3f, #1a1d28);
  border:none;
  border-radius:50%;
  box-shadow:
    0 6px 20px rgba(0,0,0,0.6),
    inset 0 3px 12px rgba(255,255,255,0.15),
    inset 0 -3px 12px rgba(0,0,0,0.4);
  cursor:pointer;
  color:#fff;
  transition: all 0.3s ease;
  display:flex;
  align-items:center;
  justify-content:center;
  animation: pulse 4s infinite ease-in-out;
}
.liquid-btn:hover, .action-btn:hover,
.liquid-btn:active, .action-btn:active {
  transform:scale(1.15);
  background:linear-gradient(145deg, #3a4055, #252a38);
  box-shadow:
    0 10px 30px rgba(76,194,255,0.5),
    inset 0 4px 15px rgba(76,194,255,0.3);
}
@keyframes pulse {
  0%, 100% { box-shadow: 0 6px 20px rgba(0,0,0,0.6), inset 0 3px 12px rgba(255,255,255,0.15); }
  50% { box-shadow: 0 8px 25px rgba(76,194,255,0.2), inset 0 4px 15px rgba(255,255,255,0.2); }
}
.action-group {
  display: flex;
  flex-direction: column;
  align-items: center;
  margin: 16px 0;
}
.action-btn {
  width:80px;
  height:80px;
  font-size:20px;
  font-weight:bold;
}
.eye-group {
  display: flex;
  justify-content: flex-end;
  margin-bottom: 8px;
}
.liquid-btn {
  width:50px;
  height:50px;
  font-size:24px;
}
/* Ø±Ø§Ø¯ÛŒÙˆ Ø¨Ø§ØªÙ†â€ŒÙ‡Ø§ÛŒ Ø³Ø§Ø¯Ù‡ Ùˆ Ø¯Ø§ÛŒØ±Ù‡â€ŒØ§ÛŒ */
.mode-selector {
  display: flex;
  justify-content: center;
  gap: 50px;
  margin: 20px 0;
  font-size: 15px;
}
.mode-option {
  display: flex;
  align-items: center;
  gap: 10px;
  cursor: pointer;
}
.mode-option input[type="radio"] {
  appearance: none;
  width: 24px;
  height: 24px;
  border: 3px solid #555;
  border-radius: 50%;
  background: transparent;
  position: relative;
  transition: all 0.3s;
}
.mode-option input[type="radio"]:checked {
  border-color: #4cc2ff;
}
.mode-option input[type="radio"]::before {
  content: "";
  position: absolute;
  width: 12px;
  height: 12px;
  background: #4cc2ff;
  border-radius: 50%;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%) scale(0);
  transition: transform 0.3s;
}
.mode-option input[type="radio"]:checked::before {
  transform: translate(-50%, -50%) scale(1);
}
.buttons {
  display:flex;
  gap:14px;
  margin:24px 0;
}
button {
  flex:1;
  padding:14px;
  border:none;
  border-radius:16px;
  font-size:15px;
  font-weight:bold;
  color:#fff;
}
#encryptBtn { background:#4cc2ff; }
#decryptBtn { background:#ff4c4c; }
.help {
  margin-top: 30px;
  padding: 16px;
  background: rgba(255,255,255,0.05);
  border-radius: 16px;
  font-size: 13px;
  line-height: 1.6;
  opacity: 0.9;
}
.help h3 { text-align: center; margin: 12px 0 8px; }
footer {
  margin-top:16px;
  text-align:center;
  font-size:12px;
  opacity:.6;
}
</style>
</head>
<body>
<div class="container">
  <div class="card">
    <h2>Secure Vault</h2>
    <!-- Paste -->
    <div class="action-group">
      <button class="action-btn" id="pasteBtn">Paste<br>ğŸ“„</button>
    </div>
    <!-- Ú†Ø´Ù… Ø¨Ø§Ù„Ø§ÛŒ ÙˆØ±ÙˆØ¯ÛŒ -->
    <div class="eye-group">
      <button class="liquid-btn" id="togglePlain">ğŸ‘</button>
    </div>
    <div class="field">
      <textarea id="plainText" placeholder="Ù…ØªÙ† Ù…Ø­Ø±Ù…Ø§Ù†Ù‡ Ø±Ø§ Ø§ÛŒÙ†Ø¬Ø§ Ø¨Ù†ÙˆÛŒØ³ÛŒØ¯ ÛŒØ§ Ù¾ÛŒØ³Øª Ú©Ù†ÛŒØ¯"></textarea>
    </div>
    <!-- Ø±Ø§Ø¯ÛŒÙˆ Ø¨Ø§ØªÙ†â€ŒÙ‡Ø§ÛŒ Ø³Ø§Ø¯Ù‡ -->
    <div class="mode-selector">
      <label class="mode-option">
        <input type="radio" name="appMode" value="file" checked>
        <span>File</span>
      </label>
      <label class="mode-option">
        <input type="radio" name="appMode" value="copy">
        <span>Copy/Paste</span>
      </label>
    </div>
    <!-- Ú†Ø´Ù… Ø¨Ø§Ù„Ø§ÛŒ Ø±Ù…Ø² -->
    <div class="eye-group">
      <button class="liquid-btn" id="togglePass">ğŸ‘</button>
    </div>
    <div class="field">
      <input id="password" type="password" placeholder="Ø±Ù…Ø² Ø¹Ø¨ÙˆØ±">
    </div>
    <div class="buttons">
      <button id="encryptBtn">Encrypt</button>
      <button id="decryptBtn">Decrypt</button>
    </div>
    <div class="field">
      <textarea id="output" placeholder="Ø®Ø±ÙˆØ¬ÛŒ Ø§ÛŒÙ†Ø¬Ø§ Ù†Ù…Ø§ÛŒØ´ Ø¯Ø§Ø¯Ù‡ Ù…ÛŒâ€ŒØ´ÙˆØ¯" readonly></textarea>
    </div>
    <!-- Copy -->
    <div class="action-group">
      <button class="action-btn" id="copyBtn">Copy<br>ğŸ“‹</button>
    </div>
    <input id="fileInput" type="file" accept=".txt,.enc" hidden>
    <div class="help">
      <h3>ğŸ“– Ø±Ø§Ù‡Ù†Ù…Ø§</h3>
      <p><strong>File Mode:</strong> ÙØ§ÛŒÙ„ Ø¯Ø§Ù†Ù„ÙˆØ¯/Ø¢Ù¾Ù„ÙˆØ¯ Ù…ÛŒâ€ŒØ´ÙˆØ¯</p>
      <p><strong>Copy/Paste Mode:</strong> ØªÙˆØµÛŒÙ‡ Ø´Ø¯Ù‡ Ø¨Ø±Ø§ÛŒ Ú¯ÙˆØ´ÛŒ</p>
      <p>Ø§Ú¯Ø± Ø¯Ú©Ù…Ù‡ Paste Ú©Ø§Ø± Ù†Ú©Ø±Ø¯: Ø¯Ø§Ø®Ù„ Ø¨Ø§Ú©Ø³ Long Press â†’ Paste</p>
    </div>
    <footer>AES-256-GCM â€¢ PBKDF2 â€¢ 100% Client-Side</footer>
  </div>
</div>
<script>
const plainText = document.getElementById("plainText");
const password = document.getElementById("password");
const output = document.getElementById("output");
const fileInput = document.getElementById("fileInput");
const copyBtn = document.getElementById("copyBtn");
const pasteBtn = document.getElementById("pasteBtn");
const encryptBtn = document.getElementById("encryptBtn");
const decryptBtn = document.getElementById("decryptBtn");
// Ú†Ø´Ù…â€ŒÙ‡Ø§
document.getElementById("togglePlain").onclick = () => {
  plainText.style.webkitTextSecurity = plainText.style.webkitTextSecurity === "disc" ? "none" : "disc";
};
document.getElementById("togglePass").onclick = () => {
  password.type = password.type === "text" ? "password" : "text";
};
// Ù¾ÛŒØ³Øª
pasteBtn.onclick = async () => {
  try {
    const text = await navigator.clipboard.readText();
    plainText.value = text.trim();
    alert("Ù…ØªÙ† Ø¨Ø§ Ù…ÙˆÙÙ‚ÛŒØª Ù¾ÛŒØ³Øª Ø´Ø¯! ğŸ‘");
  } catch (err) {
    alert("Ù¾ÛŒØ³Øª Ø§ØªÙˆÙ…Ø§ØªÛŒÚ© Ú©Ø§Ø± Ù†Ú©Ø±Ø¯ ğŸ˜•\n\nØ±Ø§Ù‡ Ø¢Ø³Ø§Ù†: Ù…ØªÙ† Ø±Ø§ Ú©Ù¾ÛŒ Ú©Ù†ÛŒØ¯ØŒ Ø³Ù¾Ø³ Ø¯Ø§Ø®Ù„ Ø¨Ø§Ú©Ø³ Long Press Ú©Ù†ÛŒØ¯ Ùˆ 'Paste' Ø±Ø§ Ø¨Ø²Ù†ÛŒØ¯.");
  }
};
// Ú©Ù¾ÛŒ
copyBtn.onclick = () => {
  if (!output.value.trim()) {
    alert("Ø®Ø±ÙˆØ¬ÛŒ Ø®Ø§Ù„ÛŒ Ø§Ø³Øª! Ø§ÙˆÙ„ Ø±Ù…Ø²Ú¯Ø°Ø§Ø±ÛŒ ÛŒØ§ Ø±Ù…Ø²Ú¯Ø´Ø§ÛŒÛŒ Ú©Ù†ÛŒØ¯.");
    return;
  }
  output.select();
  document.execCommand("copy");
  alert("Ù…ØªÙ† Ø®Ø±ÙˆØ¬ÛŒ Ú©Ù¾ÛŒ Ø´Ø¯! Ø­Ø§Ù„Ø§ Ù…ÛŒâ€ŒØªÙˆØ§Ù†ÛŒØ¯ Ø°Ø®ÛŒØ±Ù‡ Ú©Ù†ÛŒØ¯ ğŸ“‹");
};
// Ø±Ù…Ø²Ù†Ú¯Ø§Ø±ÛŒ
async function deriveKey(pass, salt) {
  const base = await crypto.subtle.importKey("raw", new TextEncoder().encode(pass), "PBKDF2", false, ["deriveKey"]);
  return crypto.subtle.deriveKey(
    {name: "PBKDF2", salt, iterations: 200000, hash: "SHA-256"},
    base, {name: "AES-GCM", length: 256}, false, ["encrypt", "decrypt"]
  );
}
async function encrypt(text, pass) {
  const salt = crypto.getRandomValues(new Uint8Array(16));
  const iv = crypto.getRandomValues(new Uint8Array(12));
  const key = await deriveKey(pass, salt);
  const cipher = await crypto.subtle.encrypt({name: "AES-GCM", iv}, key, new TextEncoder().encode(text));
  return btoa(String.fromCharCode(...salt, ...iv, ...new Uint8Array(cipher)));
}
async function decrypt(data, pass) {
  const raw = Uint8Array.from(atob(data), c => c.charCodeAt(0));
  const salt = raw.slice(0,16);
  const iv = raw.slice(16,28);
  const ct = raw.slice(28);
  const key = await deriveKey(pass, salt);
  const plain = await crypto.subtle.decrypt({name: "AES-GCM", iv}, key, ct);
  return new TextDecoder().decode(plain);
}
// Encrypt â€“ Ø¯Ø§Ù†Ù„ÙˆØ¯ Ø¨Ø¯ÙˆÙ† ØªÚ©Ø±Ø§Ø±
encryptBtn.onclick = async () => {
  if (!password.value) return alert("Ø±Ù…Ø² ÙˆØ§Ø±Ø¯ Ù†Ø´Ø¯Ù‡");
  if (!plainText.value.trim()) return alert("Ù…ØªÙ† Ø®Ø§Ù„ÛŒ Ø§Ø³Øª");
  try {
    const result = await encrypt(plainText.value.trim(), password.value);
    output.value = result;
    const isCopyMode = document.querySelector('input[name="appMode"]:checked').value === "copy";
    if (isCopyMode) {
      alert("Ø±Ù…Ø²Ú¯Ø°Ø§Ø±ÛŒ Ù…ÙˆÙÙ‚! Ø­Ø§Ù„Ø§ Ø±ÙˆÛŒ Ø¯Ú©Ù…Ù‡ Copy Ø¨Ø²Ù†ÛŒØ¯.");
    } else {
      const blob = new Blob([result], {type: "text/plain"});
      const url = URL.createObjectURL(blob);
      const a = document.createElement("a");
      a.href = url;
      a.download = "secure.enc";
      a.style.display = "none";
      document.body.appendChild(a);
      
      a.click();  // ÙÙ‚Ø· ÛŒÚ© Ø¨Ø§Ø± Ú©Ù„ÛŒÚ©

      setTimeout(() => {
        URL.revokeObjectURL(url);
        document.body.removeChild(a);
      }, 1000);

      alert("ÙØ§ÛŒÙ„ Ø±Ù…Ø²Ú¯Ø°Ø§Ø±ÛŒâ€ŒØ´Ø¯Ù‡ Ø¯Ø§Ù†Ù„ÙˆØ¯ Ø´Ø¯ (secure.enc)");
    }
    plainText.value = "";
    password.value = "";
  } catch (e) {
    alert("Ø®Ø·Ø§ Ø¯Ø± Ø±Ù…Ø²Ú¯Ø°Ø§Ø±ÛŒ");
  }
};
// Decrypt
decryptBtn.onclick = () => {
  if (!password.value) return alert("Ø±Ù…Ø² ÙˆØ§Ø±Ø¯ Ù†Ø´Ø¯Ù‡");
  const isCopyMode = document.querySelector('input[name="appMode"]:checked').value === "copy";
  if (isCopyMode) {
    if (!plainText.value.trim()) return alert("ÙˆØ±ÙˆØ¯ÛŒ Ø®Ø§Ù„ÛŒ Ø§Ø³Øª! Ù…ØªÙ† Ø±Ù…Ø² Ø´Ø¯Ù‡ Ø±Ø§ Ù¾ÛŒØ³Øª Ú©Ù†ÛŒØ¯");
    decryptFromText();
  } else {
    fileInput.click();
  }
};
async function decryptFromText() {
  try {
    output.value = await decrypt(plainText.value.trim(), password.value);
    plainText.value = "";
  } catch (e) {
    alert("Ø±Ù…Ø² Ø§Ø´ØªØ¨Ø§Ù‡ Ø§Ø³Øª ÛŒØ§ Ù…ØªÙ† Ø®Ø±Ø§Ø¨ Ø§Ø³Øª");
  }
}
fileInput.onchange = async () => {
  if (!fileInput.files[0]) return;
  try {
    const text = await fileInput.files[0].text();
    output.value = await decrypt(text, password.value);
  } catch (e) {
    alert("Ø±Ù…Ø² Ø§Ø´ØªØ¨Ø§Ù‡ Ø§Ø³Øª ÛŒØ§ ÙØ§ÛŒÙ„ Ø®Ø±Ø§Ø¨ Ø§Ø³Øª");
  }
  fileInput.value = "";
};
</script>
</body>
</html>